<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Creando mi propio GitHub Pages | AguasNegras</title><meta name=keywords content="GitHub,GitHub Pages,GitHub Actions,JBake"><meta name=description content="En 2016 decidí pasar este blog de un WordPress (que me costaba un dinero anual en hosting) a un sitio estático (aunque con comentarios de Disqus). En ese momento estuve muy influenciado por la web de Trisha que usaba esta arquitectura pero usando todo el potencial de GitHub Pages, con Jekyll y la construcción automática del sitio al subir los archivos markdown a GitHub (curiosamente ella ahora usa WordPress, pero claro tiene infinito más contenido que yo y de más calidad, jaja)."><meta name=author content="Agustín Ventura Carrasco"><link rel=canonical href=https://www.aguasnegras.es/posts/2022/10/16-github_actions/><meta name=google-site-verification content="G-W84F3CSJ3P"><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.aguasnegras.es/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.aguasnegras.es/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://www.aguasnegras.es/favicon.ico><link rel=apple-touch-icon href=https://www.aguasnegras.es/favicon.ico><link rel=mask-icon href=https://www.aguasnegras.es/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-W84F3CSJ3P"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W84F3CSJ3P",{anonymize_ip:!1})}</script><meta property="og:title" content="Creando mi propio GitHub Pages"><meta property="og:description" content="En 2016 decidí pasar este blog de un WordPress (que me costaba un dinero anual en hosting) a un sitio estático (aunque con comentarios de Disqus). En ese momento estuve muy influenciado por la web de Trisha que usaba esta arquitectura pero usando todo el potencial de GitHub Pages, con Jekyll y la construcción automática del sitio al subir los archivos markdown a GitHub (curiosamente ella ahora usa WordPress, pero claro tiene infinito más contenido que yo y de más calidad, jaja)."><meta property="og:type" content="article"><meta property="og:url" content="https://www.aguasnegras.es/posts/2022/10/16-github_actions/"><meta property="og:image" content="https://www.aguasnegras.es/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-10-16T00:00:00+00:00"><meta property="article:modified_time" content="2022-10-16T00:00:00+00:00"><meta property="og:site_name" content="AguasNegras"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.aguasnegras.es/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Creando mi propio GitHub Pages"><meta name=twitter:description content="En 2016 decidí pasar este blog de un WordPress (que me costaba un dinero anual en hosting) a un sitio estático (aunque con comentarios de Disqus). En ese momento estuve muy influenciado por la web de Trisha que usaba esta arquitectura pero usando todo el potencial de GitHub Pages, con Jekyll y la construcción automática del sitio al subir los archivos markdown a GitHub (curiosamente ella ahora usa WordPress, pero claro tiene infinito más contenido que yo y de más calidad, jaja)."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.aguasnegras.es/posts/"},{"@type":"ListItem","position":2,"name":"Creando mi propio GitHub Pages","item":"https://www.aguasnegras.es/posts/2022/10/16-github_actions/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Creando mi propio GitHub Pages","name":"Creando mi propio GitHub Pages","description":"En 2016 decidí pasar este blog de un WordPress (que me costaba un dinero anual en hosting) a un sitio estático (aunque con comentarios de Disqus). En ese momento estuve muy influenciado por la web de Trisha que usaba esta arquitectura pero usando todo el potencial de GitHub Pages, con Jekyll y la construcción automática del sitio al subir los archivos markdown a GitHub (curiosamente ella ahora usa WordPress, pero claro tiene infinito más contenido que yo y de más calidad, jaja).","keywords":["GitHub","GitHub Pages","GitHub Actions","JBake"],"articleBody":"En 2016 decidí pasar este blog de un WordPress (que me costaba un dinero anual en hosting) a un sitio estático (aunque con comentarios de Disqus). En ese momento estuve muy influenciado por la web de Trisha que usaba esta arquitectura pero usando todo el potencial de GitHub Pages, con Jekyll y la construcción automática del sitio al subir los archivos markdown a GitHub (curiosamente ella ahora usa WordPress, pero claro tiene infinito más contenido que yo y de más calidad, jaja).\nLa cosa es que en su momento no me enteraba muy bien de Jekyll ni de como modificar los temas, etc… por lo que opté por un generador de sitios estáticos en Java llamado jBake que la verdad que esta genial, pero me obligaba a dar un paso más en la gestión de la publicación. Mi workflow era el siguiente:\nEn el repositorio blog tenía los fuentes del blog (posts, plantillas, etc…) En el repositorio agustinventura.github.io estaban los htmls resultantes de mezclar los markdown con las plantillas Esto plantea varios inconvenientes:\nTener dos repositorios y mantenerlos sincronizados (cosa que hacía lanzando un sh) No aprovechar la potencia de GitHub Pages, ya que en realidad el repositorio de pages lo usaba como un simple alojamiento estático Llevo un tiempo tratando de retomar lo de escribir en el blog y eso requería primero una actualización de la infraestructura con al menos lo siguiente:\nActualización del workflow de publicación Actualización de Disqus (o quitarlo…) Actualización de materializecss o cambiarlo por otro framework CSS que siga teniendo mantenimiento Para actualizar el workflow he vuelto a mirar Jekyll y ya estaba decidido a cambiar a él, comprar un tema, etc… Cuando encontré un gran inconveniente. La cabecera de los posts con los metadatos en jBake son un formato propio mientras que en Jekyll son en FrontMatter cosa bastante más razonable, pero no estaba yo por la labor de hacer la migración de todos los posts a FrontMatter y además estoy contento con jBake, lo único que me interesaría sería tener un flujo de publicación mas automatizado, así que la opción era quedarme con jBake pero automatizar más.\n¿Se puede?\nPues sí, en 2018 GitHub lanzó su solución de DevOps, GitHub Actions. En teoría con esto podría detectar cuando hago un push de contenido, “compilarlo” usando jBake y “desplegarlo” en GitHub Pages. Cuál no sería mi sorpresa cuando descubrí que GitHub Pages por detrás funciona usando precisamente GitHub Actions y que se podía tunear!!!\nVenga, pues vamos a echarle un vistazo al workflow a medida, ¿no?\nname: Build blog sources and publish to GitHub Pages on: [push] jobs: build: runs-on: ubuntu-latest environment: name: github-pages url: ${{ steps.deployment.outputs.page_url }} permissions: id-token: write pages: write steps: - uses: actions/checkout@v3 with: ref: master - uses: sdkman/sdkman-action@master with: candidate: java version: 17.0.4.1-tem - uses: actions/setup-java@v1 with: java-version: 17.0.4.1 jdkFile: ${{ steps.sdkman.outputs.file }} - uses: wei/wget@v1 with: args: -q https://github.com/jbake-org/jbake/releases/download/v2.6.7/jbake-2.6.7-bin.zip -O jbake-2.6.7-bin.zip - uses: montudor/action-zip@v1 with: args: unzip -qq jbake-2.6.7-bin.zip -d . - run: sh jbake-2.6.7-bin/bin/jbake -b sources _site - uses: actions/upload-pages-artifact@v0 with: path: ./_site retention-days: 1 - uses: actions/deploy-pages@v1 with: artifact_name: github-pages preview: false token: ${{ github.token }} Lo primero que hay que entender aquí es que he aprendido GitHub Actions sobre la marcha así que seguro que hay mucho que mejorar, jaja. La estructura básica de un workflow es que tiene varios jobs que a su vez pueden tener varios steps, aunque en este caso tenemos un único job con ocho pasos.\nLo primero es darle un nombre y decirle cuando se va a ejecutar (el on), en este caso con cualquier push (solo va a haber una rama, master porque este repositorio es añejo, si fuera más moderno sería main). Tras eso defino el job de la siguiente manera: El entorno de ejecución será la última ubuntu (el run-on: ubuntu-latest). El environment representa el entorno de despliegue. Se pueden crear los entornos que se deseen para cualquier repositorio (por ejemplo, dev o prod) pero cuando tienes habilitado GitHub Pages en un repositorio se define automáticamente un entorno llamado github-pages. Aquí hay que referenciarlo para saber donde desplegar. En permissions hablamos de los permisos que va a tener el job (representado a través de un token llamado GITHUB_TOKEN), en este caso le damos permisos de escritura para sí mismo (hará falta para una action posterior) y permisos de escritura en pages (GitHub Pages, se entiende). Y empezamos con los pasos en sí que son bastante sencillos:\nCon checkout@v3 se descarga la rama master del repositorio, el último commit nada más. Con sdkman-action se instala sdkman y Java para ejecutar jBake setup-java es autoexplicativo, se configura el Java que se acaba de instalar Para jBake tenemos que dar dos pasos: primero descargarlo usando wget Segundo, descomprimirlo usando el action-zip Pues ya estaría el entorno instalado y configurado y los fuentes bajados, así que con el run de jbake le digo que compile los fuentes del blog que estan en la carpeta sources y los deje en _site Con uploads-pages-artifact lo que se hace es generar un zip con los archivos del blog (_site) Y por último, con deploy-pages, se sube el artefacto al environment de GitHub Pages. Aquí es donde necesito el token y por eso tengo que darle permisos de escritura del token en sí. Y listo, con esto simplifico el contenido del repositorio (ya solo contiene los fuentes y el CNAME) y puedo publicar simplemente haciendo push.\n","wordCount":"901","inLanguage":"en","datePublished":"2022-10-16T00:00:00Z","dateModified":"2022-10-16T00:00:00Z","author":{"@type":"Person","name":"Agustín Ventura Carrasco"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.aguasnegras.es/posts/2022/10/16-github_actions/"},"publisher":{"@type":"Organization","name":"AguasNegras","logo":{"@type":"ImageObject","url":"https://www.aguasnegras.es/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.aguasnegras.es/ accesskey=h title="AguasNegras (Alt + H)">AguasNegras</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.aguasnegras.es/archives/ title=archivos><span>archivos</span></a></li><li><a href=https://www.aguasnegras.es/tags/ title=tags><span>tags</span></a></li><li><a href=https://www.aguasnegras.es/about/ title="acerca de"><span>acerca de</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.aguasnegras.es/>Home</a>&nbsp;»&nbsp;<a href=https://www.aguasnegras.es/posts/>Posts</a></div><h1 class=post-title>Creando mi propio GitHub Pages</h1><div class=post-meta><span title='2022-10-16 00:00:00 +0000 UTC'>16 October 2022</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;901 words&nbsp;·&nbsp;Agustín Ventura Carrasco&nbsp;|&nbsp;<a href=https://github.com/agustinventura.github.io/content/posts/2022/10/16-github_actions.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>En <a href=https://www.aguasnegras.es/blog/2016/06/10-wp2jbake-generacion.html>2016</a> decidí pasar este blog de un WordPress (que me costaba un dinero anual en hosting) a un sitio estático (aunque con comentarios de Disqus). En ese momento estuve muy influenciado
por la web de <a href=https://trishagee.com/>Trisha</a> que usaba esta arquitectura pero usando todo el potencial de GitHub Pages, con Jekyll y la construcción automática del sitio al subir los
archivos markdown a GitHub (curiosamente ella ahora usa WordPress, pero claro tiene infinito más contenido que yo y de más calidad, jaja).</p><p>La cosa es que en su momento no me enteraba muy bien de Jekyll ni de como modificar los temas, etc&mldr; por lo que opté por un generador de sitios estáticos en Java llamado <a href=https://jbake.org/>jBake</a>
que la verdad que esta genial, pero me obligaba a dar un paso más en la gestión de la publicación. Mi workflow era el siguiente:</p><ol><li>En el repositorio <a href=https://github.com/agustinventura/blog>blog</a> tenía los fuentes del blog (posts, plantillas, etc&mldr;)</li><li>En el repositorio <a href=https://github.com/agustinventura/agustinventura.github.io>agustinventura.github.io</a> estaban los htmls resultantes de mezclar los markdown con las plantillas</li></ol><p>Esto plantea varios inconvenientes:</p><ul><li>Tener dos repositorios y mantenerlos sincronizados (cosa que hacía lanzando un sh)</li><li>No aprovechar la potencia de GitHub Pages, ya que en realidad el repositorio de pages lo usaba como un simple alojamiento estático</li></ul><p>Llevo un tiempo tratando de retomar lo de escribir en el blog y eso requería primero una actualización de la infraestructura con al menos lo siguiente:</p><ul><li>Actualización del workflow de publicación</li><li>Actualización de Disqus (o quitarlo&mldr;)</li><li>Actualización de materializecss o cambiarlo por otro framework CSS que siga teniendo mantenimiento</li></ul><p>Para actualizar el workflow he vuelto a mirar Jekyll y ya estaba decidido a cambiar a él, comprar un tema, etc&mldr; Cuando encontré un gran inconveniente. La cabecera de los posts con los metadatos
en jBake son un <a href=https://jbake.org/docs/2.6.5/#metadata_header>formato propio</a> mientras que en Jekyll son en <a href=https://jekyllrb.com/docs/front-matter/>FrontMatter</a> cosa bastante más
razonable, pero no estaba yo por la labor de hacer la migración de todos los posts a FrontMatter y además estoy contento con jBake, lo único que me interesaría sería tener un flujo de publicación
mas automatizado, así que la opción era quedarme con jBake pero automatizar más.</p><p>¿Se puede?</p><p>Pues sí, en 2018 GitHub lanzó su solución de DevOps, <a href=https://github.com/features/actions>GitHub Actions</a>. En teoría con esto podría detectar cuando hago un push de contenido, &ldquo;compilarlo&rdquo;
usando jBake y &ldquo;desplegarlo&rdquo; en GitHub Pages.
Cuál no sería mi sorpresa cuando descubrí que GitHub Pages por detrás funciona usando precisamente GitHub Actions y que se podía <a href=https://docs.github.com/en/pages/getting-started-with-github-pages/configuring-a-publishing-source-for-your-github-pages-site#publishing-with-a-custom-github-actions-workflow>tunear</a>!!!</p><p>Venga, pues vamos a echarle un vistazo al workflow a medida, ¿no?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Build blog sources and publish to GitHub Pages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>on</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>push]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>build</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>github-pages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>${{ steps.deployment.outputs.page_url }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>permissions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>id-token</span><span class=p>:</span><span class=w> </span><span class=l>write</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>pages</span><span class=p>:</span><span class=w> </span><span class=l>write</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>ref</span><span class=p>:</span><span class=w> </span><span class=l>master</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>sdkman/sdkman-action@master</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>candidate</span><span class=p>:</span><span class=w> </span><span class=l>java</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>17.0.4.1</span>-<span class=l>tem</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/setup-java@v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>java-version</span><span class=p>:</span><span class=w> </span><span class=m>17.0.4.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>jdkFile</span><span class=p>:</span><span class=w> </span><span class=l>${{ steps.sdkman.outputs.file }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>wei/wget@v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>args</span><span class=p>:</span><span class=w> </span>-<span class=l>q https://github.com/jbake-org/jbake/releases/download/v2.6.7/jbake-2.6.7-bin.zip -O jbake-2.6.7-bin.zip</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>montudor/action-zip@v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>args</span><span class=p>:</span><span class=w> </span><span class=l>unzip -qq jbake-2.6.7-bin.zip -d .</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>sh jbake-2.6.7-bin/bin/jbake -b sources _site</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/upload-pages-artifact@v0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>./_site</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>retention-days</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/deploy-pages@v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>artifact_name</span><span class=p>:</span><span class=w> </span><span class=l>github-pages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>preview</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>token</span><span class=p>:</span><span class=w> </span><span class=l>${{ github.token }}</span><span class=w>
</span></span></span></code></pre></div><p>Lo primero que hay que entender aquí es que he aprendido GitHub Actions sobre la marcha así que seguro que hay mucho que mejorar, jaja. La estructura básica de un workflow es que tiene varios jobs
que a su vez pueden tener varios steps, aunque en este caso tenemos un único job con ocho pasos.</p><p>Lo primero es darle un nombre y decirle cuando se va a ejecutar (el on), en este caso con cualquier push (solo va a haber una rama, master porque este repositorio es añejo, si fuera más moderno sería main).
Tras eso defino el job de la siguiente manera:
El entorno de ejecución será la última ubuntu (el run-on: ubuntu-latest). El environment representa el entorno de despliegue. Se pueden crear los entornos que se deseen para cualquier repositorio
(por ejemplo, dev o prod) pero cuando tienes habilitado GitHub Pages en un repositorio se define automáticamente un entorno llamado github-pages. Aquí hay que referenciarlo para saber donde desplegar.
En permissions hablamos de los permisos que va a tener el job (representado a través de un token llamado GITHUB_TOKEN), en este caso le damos permisos de escritura para sí mismo (hará falta para una
action posterior) y permisos de escritura en pages (GitHub Pages, se entiende).
Y empezamos con los pasos en sí que son bastante sencillos:</p><ol><li>Con checkout@v3 se descarga la rama master del repositorio, el último commit nada más.</li><li>Con sdkman-action se instala <a href=https://www.aguasnegras.es/blog/2018/10/12-sdkman.html>sdkman</a> y Java para ejecutar jBake</li><li>setup-java es autoexplicativo, se configura el Java que se acaba de instalar</li><li>Para jBake tenemos que dar dos pasos: primero descargarlo usando wget</li><li>Segundo, descomprimirlo usando el action-zip</li><li>Pues ya estaría el entorno instalado y configurado y los fuentes bajados, así que con el run de jbake le digo que compile los fuentes del blog que estan en la carpeta sources y los deje en _site</li><li>Con uploads-pages-artifact lo que se hace es generar un zip con los archivos del blog (_site)</li><li>Y por último, con deploy-pages, se sube el artefacto al environment de GitHub Pages. Aquí es donde necesito el token y por eso tengo que darle permisos de escritura del token en sí.</li></ol><p>Y listo, con esto simplifico el contenido del repositorio (ya solo contiene los fuentes y el CNAME) y puedo publicar simplemente haciendo push.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.aguasnegras.es/tags/github/>GitHub</a></li><li><a href=https://www.aguasnegras.es/tags/github-pages/>GitHub Pages</a></li><li><a href=https://www.aguasnegras.es/tags/github-actions/>GitHub Actions</a></li><li><a href=https://www.aguasnegras.es/tags/jbake/>JBake</a></li></ul><nav class=paginav><a class=next href=https://www.aguasnegras.es/posts/2020/07/10-credenciales_git_libsecret/><span class=title>Next »</span><br><span>Gestión de Credenciales de Git en Ubuntu Linux</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Creando mi propio GitHub Pages on twitter" href="https://twitter.com/intent/tweet/?text=Creando%20mi%20propio%20GitHub%20Pages&url=https%3a%2f%2fwww.aguasnegras.es%2fposts%2f2022%2f10%2f16-github_actions%2f&hashtags=GitHub%2cGitHubPages%2cGitHubActions%2cJBake"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Creando mi propio GitHub Pages on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fwww.aguasnegras.es%2fposts%2f2022%2f10%2f16-github_actions%2f&title=Creando%20mi%20propio%20GitHub%20Pages&summary=Creando%20mi%20propio%20GitHub%20Pages&source=https%3a%2f%2fwww.aguasnegras.es%2fposts%2f2022%2f10%2f16-github_actions%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Creando mi propio GitHub Pages on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwww.aguasnegras.es%2fposts%2f2022%2f10%2f16-github_actions%2f&title=Creando%20mi%20propio%20GitHub%20Pages"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Creando mi propio GitHub Pages on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.aguasnegras.es%2fposts%2f2022%2f10%2f16-github_actions%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Creando mi propio GitHub Pages on whatsapp" href="https://api.whatsapp.com/send?text=Creando%20mi%20propio%20GitHub%20Pages%20-%20https%3a%2f%2fwww.aguasnegras.es%2fposts%2f2022%2f10%2f16-github_actions%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Creando mi propio GitHub Pages on telegram" href="https://telegram.me/share/url?text=Creando%20mi%20propio%20GitHub%20Pages&url=https%3a%2f%2fwww.aguasnegras.es%2fposts%2f2022%2f10%2f16-github_actions%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://www.aguasnegras.es/>AguasNegras</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>